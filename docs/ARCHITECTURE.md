# ç³»ç»Ÿæ¶æ„è®¾è®¡æ–‡æ¡£

## ğŸ“‹ ç›®å½•

- [æ¦‚è¿°](#æ¦‚è¿°)
- [æ¶æ„è®¾è®¡åŸåˆ™](#æ¶æ„è®¾è®¡åŸåˆ™)
- [åˆ†å±‚æ¶æ„](#åˆ†å±‚æ¶æ„)
- [æ ¸å¿ƒæµç¨‹](#æ ¸å¿ƒæµç¨‹)
- [è®¾è®¡æ¨¡å¼](#è®¾è®¡æ¨¡å¼)
- [æ•°æ®æµ](#æ•°æ®æµ)
- [å¹¶å‘æ¨¡å‹](#å¹¶å‘æ¨¡å‹)
- [ç¼“å­˜ç­–ç•¥](#ç¼“å­˜ç­–ç•¥)
- [é”™è¯¯å¤„ç†](#é”™è¯¯å¤„ç†)

---

## æ¦‚è¿°

äº’è”ç½‘è°£è¨€ç²‰ç¢æœºæ˜¯ä¸€ä¸ªåŸºäºRAGï¼ˆRetrieval-Augmented Generationï¼‰å’ŒLLMçš„æ™ºèƒ½è°£è¨€æ ¸æŸ¥ç³»ç»Ÿã€‚ç³»ç»Ÿé‡‡ç”¨åˆ†å±‚æ¶æ„å’Œåè°ƒå™¨æ¨¡å¼ï¼Œå…·å¤‡é«˜æ€§èƒ½ã€é«˜å¯ç»´æŠ¤æ€§å’Œè‡ªæˆ‘è¿›åŒ–èƒ½åŠ›ã€‚

### æ ¸å¿ƒèƒ½åŠ›

1. **æ™ºèƒ½æ ¸æŸ¥**: åŸºäºè¯­ä¹‰æ£€ç´¢å’ŒLLMåˆ†æï¼Œå‡†ç¡®è¯„ä¼°è°£è¨€çœŸä¼ª
2. **å®æ—¶æœç´¢**: é›†æˆäº’è”ç½‘æœç´¢ï¼Œè·å–æœ€æ–°ä¿¡æ¯
3. **æ€§èƒ½ä¼˜åŒ–**: åŠ¨æ€å¹¶è¡Œåº¦è°ƒæ•´ï¼Œå……åˆ†åˆ©ç”¨å¤šæ ¸èµ„æº
4. **æˆæœ¬æ§åˆ¶**: APIä½¿ç”¨ç›‘æ§ï¼Œé˜²æ­¢æˆæœ¬å¤±æ§
5. **è‡ªæˆ‘è¿›åŒ–**: é«˜ç½®ä¿¡åº¦ç»“æœè‡ªåŠ¨è½¬åŒ–ä¸ºæœ¬åœ°çŸ¥è¯†

---

## æ¶æ„è®¾è®¡åŸåˆ™

### 1. åˆ†å±‚æ¶æ„ (Layered Architecture)

ç³»ç»Ÿé‡‡ç”¨æ¸…æ™°çš„åˆ†å±‚ç»“æ„ï¼Œæ¯å±‚è´Ÿè´£ç‰¹å®šèŒè´£ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     é—¨é¢å±‚ (Facade Layer)           â”‚
â”‚  RumorJudgeEngine (å•ä¾‹)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     åè°ƒå™¨å±‚ (Coordinator Layer)    â”‚
â”‚  QueryProcessor                      â”‚
â”‚  RetrievalCoordinator               â”‚
â”‚  AnalysisCoordinator                â”‚
â”‚  VerdictGenerator                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      æœåŠ¡å±‚ (Service Layer)         â”‚
â”‚  QueryParser, EvidenceAnalyzer     â”‚
â”‚  TruthSummarizer, HybridRetriever  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    åŸºç¡€è®¾æ–½å±‚ (Infrastructure)      â”‚
â”‚  CacheManager, KnowledgeBase       â”‚
â”‚  WebSearchTool, Embeddings          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. å•ä¸€èŒè´£åŸåˆ™ (Single Responsibility Principle)

æ¯ä¸ªç±»åªè´Ÿè´£ä¸€ä¸ªæ˜ç¡®çš„åŠŸèƒ½ï¼š
- **QueryProcessor**: åªè´Ÿè´£æŸ¥è¯¢å¤„ç†
- **RetrievalCoordinator**: åªè´Ÿè´£æ£€ç´¢åè°ƒ
- **AnalysisCoordinator**: åªè´Ÿè´£åˆ†æåè°ƒ
- **VerdictGenerator**: åªè´Ÿè´£è£å†³ç”Ÿæˆ

### 3. å¼€é—­åŸåˆ™ (Open-Closed Principle)

- å¯¹æ‰©å±•å¼€æ”¾ï¼šå¯ä»¥æ·»åŠ æ–°çš„åè°ƒå™¨
- å¯¹ä¿®æ”¹å°é—­ï¼šæ ¸å¿ƒæµç¨‹ä¸éœ€è¦ä¿®æ”¹

### 4. ä¾èµ–å€’ç½®åŸåˆ™ (Dependency Inversion Principle)

é«˜å±‚æ¨¡å—ä¸ä¾èµ–ä½å±‚æ¨¡å—ï¼Œéƒ½ä¾èµ–æŠ½è±¡ï¼š
- åè°ƒå™¨ä¾èµ–æ¥å£ï¼Œä¸ä¾èµ–å…·ä½“å®ç°
- é€šè¿‡ä¾èµ–æ³¨å…¥å®ç°è§£è€¦

---

## åˆ†å±‚æ¶æ„

### 1. é—¨é¢å±‚ (Facade Layer)

**RumorJudgeEngine** - `src/core/pipeline.py`

**èŒè´£**ï¼š
- æä¾›ç®€å•çš„APIæ¥å£
- ç¼–æ’æ•´ä¸ªæ ¸æŸ¥æµç¨‹
- ç®¡ç†ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ
- ç»Ÿä¸€é”™è¯¯å¤„ç†

**å…³é”®è®¾è®¡**ï¼š
- å•ä¾‹æ¨¡å¼ï¼šç¡®ä¿å…¨å±€åªæœ‰ä¸€ä¸ªå®ä¾‹
- å»¶è¿Ÿåˆå§‹åŒ–ï¼šç»„ä»¶åœ¨çœŸæ­£éœ€è¦æ—¶æ‰åŠ è½½
- çº¿ç¨‹å®‰å…¨ï¼šä½¿ç”¨ç»†ç²’åº¦é”ä¿è¯å¹¶å‘å®‰å…¨

**APIç¤ºä¾‹**ï¼š
```python
engine = RumorJudgeEngine()
result = engine.run("æŸ¥è¯¢å†…å®¹", use_cache=True)
```

### 2. åè°ƒå™¨å±‚ (Coordinator Layer)

#### QueryProcessor

**èŒè´£**ï¼š
- è§£ææŸ¥è¯¢ï¼ˆæå–å®ä½“ã€ä¸»å¼ ã€åˆ†ç±»ï¼‰
- ç¼“å­˜æ£€æŸ¥
- å¹¶è¡Œæ‰§è¡ŒæŸ¥è¯¢è§£æå’Œæœ¬åœ°æ£€ç´¢

**å…³é”®æ–¹æ³•**ï¼š
- `parse_query()`: è§£ææŸ¥è¯¢æ„å›¾
- `check_cache()`: æ£€æŸ¥ç¼“å­˜
- `parse_with_parallel_retrieval()`: å¹¶è¡Œè§£æå’Œæ£€ç´¢

**æ€§èƒ½ä¼˜åŒ–**ï¼š
- æŠ¢è·‘ç­–ç•¥ï¼šåˆ©ç”¨LLMåˆ†ææ—¶é—´é¢„å…ˆæ£€ç´¢æœ¬åœ°åº“
- å¹¶è¡Œæ‰§è¡Œï¼šè§£æå’Œæ£€ç´¢åŒæ—¶è¿›è¡Œ

#### RetrievalCoordinator

**èŒè´£**ï¼š
- åè°ƒæœ¬åœ°æ£€ç´¢å’Œç½‘ç»œæœç´¢
- è¯æ®å»é‡
- æ ¼å¼è½¬æ¢

**å…³é”®æ–¹æ³•**ï¼š
- `retrieve()`: æ‰§è¡Œæ£€ç´¢
- `retrieve_with_parsed_query()`: ä½¿ç”¨è§£æåçš„æŸ¥è¯¢æ£€ç´¢
- `_deduplicate_docs()`: æ–‡æ¡£å»é‡
- `_convert_to_dict_format()`: æ ¼å¼è½¬æ¢

**æ£€ç´¢ç­–ç•¥**ï¼š
1. æŠ¢è·‘ï¼šåŸå§‹è¯æœ¬åœ°æ£€ç´¢
2. è¡¥æµ‹ï¼šè§£æè¯æœ¬åœ°æ£€ç´¢
3. æ··åˆï¼šæœ¬åœ°+ç½‘ç»œæ··åˆæ£€ç´¢

#### AnalysisCoordinator

**èŒè´£**ï¼š
- åè°ƒè¯æ®åˆ†æ
- æ‰¹é‡å¹¶è¡Œåˆ†æ
- æ±‡æ€»åˆ†æç»“æœ

**å…³é”®æ–¹æ³•**ï¼š
- `analyze()`: åˆ†æè¯æ®åˆ—è¡¨
- `summarize_assessments()`: æ±‡æ€»è¯„ä¼°
- `get_high_quality_evidence()`: ç­›é€‰é«˜è´¨é‡è¯æ®

**å¹¶è¡Œç­–ç•¥**ï¼š
- 2-5ä¸ªè¯æ®ï¼šå•è¯æ®å¹¶è¡Œåˆ†æ
- >5ä¸ªè¯æ®ï¼šåˆ†ç‰‡å¹¶è¡Œåˆ†æ

#### VerdictGenerator

**èŒè´£**ï¼š
- ç”Ÿæˆæœ€ç»ˆè£å†³
- å…œåº•æœºåˆ¶
- æ ¼å¼åŒ–è¾“å‡º

**å…³é”®æ–¹æ³•**ï¼š
- `generate()`: ç”Ÿæˆè£å†³
- `format_for_cache()`: æ ¼å¼åŒ–ä¸ºç¼“å­˜æ ¼å¼
- `extract_key_info()`: æå–å…³é”®ä¿¡æ¯

### 3. æœåŠ¡å±‚ (Service Layer)

#### æŸ¥è¯¢è§£ææœåŠ¡

**QueryParser** - `src/analyzers/query_parser.py`
- ä½¿ç”¨LLMè§£ææŸ¥è¯¢æ„å›¾
- æå–å®ä½“ã€ä¸»å¼ ã€åˆ†ç±»
- æ”¯æŒå¤šç§æŸ¥è¯¢ç±»å‹

#### è¯æ®åˆ†ææœåŠ¡

**EvidenceAnalyzer** - `src/analyzers/evidence_analyzer.py`
- å¤šè§’åº¦è¯„ä¼°è¯æ®
- é¢„è¿‡æ»¤æœºåˆ¶
- æ‰¹é‡å¹¶è¡Œåˆ†æ

#### è£å†³ç”ŸæˆæœåŠ¡

**TruthSummarizer** - `src/analyzers/truth_summarizer.py`
- ç»¼åˆè¯æ®ç”Ÿæˆè£å†³
- é‡è¯•æœºåˆ¶
- å…œåº•åˆ†æ

#### æ£€ç´¢æœåŠ¡

**HybridRetriever** - `src/retrievers/hybrid_retriever.py`
- æ··åˆæ£€ç´¢ï¼ˆæœ¬åœ°+ç½‘ç»œï¼‰
- ç›¸ä¼¼åº¦é˜ˆå€¼åˆ¤æ–­
- ç»“æœå»é‡

### 4. åŸºç¡€è®¾æ–½å±‚ (Infrastructure Layer)

#### ç¼“å­˜ç®¡ç†

**CacheManager** - `src/core/cache_manager.py`
- ç²¾ç¡®åŒ¹é…ç¼“å­˜
- è¯­ä¹‰å‘é‡ç¼“å­˜
- ç‰ˆæœ¬æ„ŸçŸ¥

#### çŸ¥è¯†ç®¡ç†

**KnowledgeIntegrator** - `src/knowledge/knowledge_integrator.py`
- è‡ªåŠ¨ç”ŸæˆçŸ¥è¯†å†…å®¹
- å¢é‡æ›´æ–°å‘é‡åº“
- åå°å¼‚æ­¥æ‰§è¡Œ

#### å¯è§‚æµ‹æ€§

**APIMonitor** - `src/observability/api_monitor.py`
- APIä½¿ç”¨ç»Ÿè®¡
- æˆæœ¬è¿½è¸ª
- é…é¢ç›‘æ§

**ParallelismConfig** - `src/core/parallelism_config.py`
- åŠ¨æ€å¹¶è¡Œåº¦è°ƒæ•´
- åŸºäºCPUæ ¸å¿ƒæ•°è‡ªåŠ¨è®¡ç®—
- æ”¯æŒç¯å¢ƒå˜é‡é…ç½®

---

## æ ¸å¿ƒæµç¨‹

### æ ‡å‡†æ ¸æŸ¥æµç¨‹

```
1. æ¥æ”¶æŸ¥è¯¢
   â†“
2. QueryProcessor.parse_with_parallel_retrieval()
   â”œâ”€ LLMè§£ææŸ¥è¯¢æ„å›¾ (å¹¶è¡Œ)
   â””â”€ æœ¬åœ°å‘é‡æ£€ç´¢ (å¹¶è¡Œ)
   â†“
3. QueryProcessor.check_cache()
   â”œâ”€ å‘½ä¸­ â†’ è¿”å›ç¼“å­˜ç»“æœ
   â””â”€ æœªå‘½ä¸­ â†’ ç»§ç»­
   â†“
4. RetrievalCoordinator.retrieve_with_parsed_query()
   â”œâ”€ æŠ¢è·‘æœ¬åœ°æ£€ç´¢ (å·²åœ¨æ­¥éª¤2å®Œæˆ)
   â”œâ”€ è§£æè¯è¡¥æµ‹æœ¬åœ°æ£€ç´¢
   â””â”€ æ··åˆæ£€ç´¢ (æœ¬åœ°+ç½‘ç»œ)
   â†“
5. RetrievalCoordinator._deduplicate_docs()
   â†“
6. AnalysisCoordinator.analyze()
   â”œâ”€ é¢„è¿‡æ»¤
   â”œâ”€ æ‰¹é‡å¹¶è¡Œåˆ†æ
   â””â”€ æ±‡æ€»ç»“æœ
   â†“
7. VerdictGenerator.generate()
   â”œâ”€ æœ‰è¯æ® â†’ summarize_truth()
   â””â”€ æ— è¯æ® â†’ summarize_with_fallback()
   â†“
8. CacheManager.set_verdict()
   â†“
9. RumorJudgeEngine._auto_integrate_knowledge()
   â”œâ”€ æ£€æŸ¥æ˜¯å¦æ»¡è¶³æ¡ä»¶
   â””â”€ åå°å¼‚æ­¥é›†æˆ
   â†“
10. è¿”å› UnifiedVerificationResult
```

### æ—¶é—´çº¿åˆ†æï¼ˆå…¸å‹åœºæ™¯ï¼‰

| é˜¶æ®µ | è€—æ—¶ | è¯´æ˜ |
|------|------|------|
| ç¼“å­˜æ£€æŸ¥ | <5ms | è¯­ä¹‰å‘é‡æ£€ç´¢ |
| æŸ¥è¯¢è§£æ + æŠ¢è·‘æ£€ç´¢ | ~2s | LLMè°ƒç”¨ + å‘é‡æ£€ç´¢å¹¶è¡Œ |
| è¡¥æµ‹æ£€ç´¢ | ~1s | é¢å¤–çš„å‘é‡æ£€ç´¢ |
| è¯æ®åˆ†æ | ~5s | 3ä¸ªè¯æ®å¹¶è¡Œåˆ†æ |
| è£å†³ç”Ÿæˆ | ~8s | LLMç”Ÿæˆæœ€ç»ˆè£å†³ |
| **æ€»è®¡** | **~16s** | æœ¬åœ°å‘½ä¸­åœºæ™¯ |

---

## è®¾è®¡æ¨¡å¼

### 1. é—¨é¢æ¨¡å¼ (Facade)

**RumorJudgeEngine** ä½œä¸ºé—¨é¢ï¼Œéšè—ç³»ç»Ÿå¤æ‚æ€§ï¼š

```python
# ç®€å•çš„APIæ¥å£
result = engine.run("æŸ¥è¯¢")
# å†…éƒ¨è‡ªåŠ¨åè°ƒå¤šä¸ªåè°ƒå™¨
```

### 2. åè°ƒå™¨æ¨¡å¼ (Coordinator)

å°†å¤æ‚çš„æµç¨‹ç¼–æ’åˆ†ç¦»åˆ°ä¸“é—¨çš„åè°ƒå™¨ï¼š
- **å¥½å¤„**: èŒè´£æ¸…æ™°ï¼Œæ˜“äºç»´æŠ¤
- **å®ç°**: 4ä¸ªåè°ƒå™¨å„å¸å…¶èŒ

### 3. ç­–ç•¥æ¨¡å¼ (Strategy)

ä¸åŒçš„æ£€ç´¢ç­–ç•¥ï¼š
- `retrieve()`: ç®€å•æ£€ç´¢
- `retrieve_with_parsed_query()`: è§£æè¯æ£€ç´¢
- `retrieve_local_only()`: ä»…æœ¬åœ°æ£€ç´¢

### 4. æ¨¡æ¿æ–¹æ³•æ¨¡å¼ (Template Method)

æ ‡å‡†åŒ–çš„å¤„ç†æµç¨‹æ¨¡æ¿ï¼š
1. æŸ¥è¯¢å¤„ç†
2. è¯æ®æ£€ç´¢
3. è¯æ®åˆ†æ
4. è£å†³ç”Ÿæˆ

### 5. å•ä¾‹æ¨¡å¼ (Singleton)

**RumorJudgeEngine** å•ä¾‹å®ç°ï¼š
- çº¿ç¨‹å®‰å…¨çš„å•ä¾‹åˆ›å»º
- å»¶è¿Ÿåˆå§‹åŒ–
- åŒé‡æ£€æŸ¥é”å®š

### 6. å·¥å‚æ¨¡å¼ (Factory)

**ä¾èµ–æ³¨å…¥**ï¼š
- ç»„ä»¶é€šè¿‡å·¥å‚å‡½æ•°åˆ›å»º
- æ”¯æŒMockå’Œæµ‹è¯•

---

## æ•°æ®æµ

### 1. æŸ¥è¯¢æ•°æ®æµ

```
ç”¨æˆ·æŸ¥è¯¢
    â†“
QueryParser â†’ QueryAnalysis
    â†“ (entity, claim, category)
Retriever â†’ List[Document]
    â†“
Analyzer â†’ List[EvidenceAssessment]
    â†“
Summarizer â†’ FinalVerdict
    â†“
UnifiedVerificationResult
```

### 2. ç¼“å­˜æ•°æ®æµ

```
æŸ¥è¯¢ â†’ MD5å“ˆå¸Œ â†’ ç²¾ç¡®ç¼“å­˜
     â†“
     æœªå‘½ä¸­
     â†“
æŸ¥è¯¢ â†’ Embeddings â†’ å‘é‡æ£€ç´¢ â†’ è¯­ä¹‰ç¼“å­˜
     â†“
     æœªå‘½ä¸­
     â†“
æ‰§è¡Œå®Œæ•´æµç¨‹ â†’ ç¼“å­˜ç»“æœ
```

### 3. çŸ¥è¯†é›†æˆæ•°æ®æµ

```
é«˜ç½®ä¿¡åº¦ç»“æœ
    â†“
æ£€æŸ¥æ¡ä»¶ï¼ˆè£å†³æ˜ç¡®ã€ç½®ä¿¡åº¦é«˜ã€è¯æ®å……è¶³ï¼‰
    â†“
ç”ŸæˆçŸ¥è¯†å†…å®¹
    â†“
å†™å…¥æ–‡ä»¶ (AUTO_GEN_*.txt)
    â†“
åå°å¼‚æ­¥é‡æ„å‘é‡åº“
```

---

## å¹¶å‘æ¨¡å‹

### 1. çº¿ç¨‹å®‰å…¨æ¶æ„

```
RumorJudgeEngine (å•ä¾‹)
â”œâ”€â”€ _singleton_lock (å•ä¾‹åˆ›å»ºä¸“ç”¨)
â”œâ”€â”€ LockManager
â”‚   â”œâ”€â”€ component_init (ç»„ä»¶åˆå§‹åŒ–é”)
â”‚   â”œâ”€â”€ knowledge_integration (çŸ¥è¯†é›†æˆé”)
â”‚   â””â”€â”€ ...
â””â”€â”€ ç»„ä»¶
    â”œâ”€â”€ BatchEmbedder (_cache_lock, _stats_lock)
    â”œâ”€â”€ CacheManager (thread-safe)
    â””â”€â”€ ...
```

### 2. å¹¶è¡Œæ‰§è¡Œç­–ç•¥

#### æŸ¥è¯¢å¤„ç†é˜¶æ®µ

```python
with ThreadPoolExecutor(max_workers=2) as executor:
    # ä»»åŠ¡1: LLMè§£æ
    parse_future = executor.submit(parser_chain.invoke, query)
    # ä»»åŠ¡2: æœ¬åœ°æ£€ç´¢
    search_future = executor.submit(retriever.search_local, query)
```

#### è¯æ®åˆ†æé˜¶æ®µ

```python
# å•è¯æ®å¹¶è¡Œåˆ†æï¼ˆ2-5ä¸ªè¯æ®ï¼‰
with ThreadPoolExecutor(max_workers=task_count) as executor:
    for evidence in evidence_list:
        executor.submit(analyze_single, evidence)

# åˆ†ç‰‡å¹¶è¡Œåˆ†æï¼ˆ>5ä¸ªè¯æ®ï¼‰
chunk_size = 5
for chunk in chunks:
    executor.submit(analyze_batch, chunk)
```

### 3. åŠ¨æ€å¹¶è¡Œåº¦

**ParallelismConfig** æ ¹æ®CPUæ ¸å¿ƒæ•°è‡ªåŠ¨è°ƒæ•´ï¼š

```python
# 16æ ¸æœºå™¨
default: 10 workers
evidence_analyzer: 15 workers
retrieval: 12 workers
embedding: 8 workers
```

---

## ç¼“å­˜ç­–ç•¥

### 1. åŒå±‚ç¼“å­˜æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç²¾ç¡®åŒ¹é…ç¼“å­˜ (å†…å­˜)            â”‚
â”‚   - MD5å“ˆå¸Œ                     â”‚
â”‚   - é€Ÿåº¦: <1ms                  â”‚
â”‚   - å‘½ä¸­ç‡: ~10%                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚ æœªå‘½ä¸­
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   è¯­ä¹‰å‘é‡ç¼“å­˜ (ChromaDB)        â”‚
â”‚   - ç›¸ä¼¼åº¦é˜ˆå€¼: 0.96             â”‚
â”‚   - é€Ÿåº¦: <5ms                  â”‚
â”‚   - å‘½ä¸­ç‡: ~30%                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚ æœªå‘½ä¸­
              â†“
        æ‰§è¡Œå®Œæ•´æµç¨‹
```

### 2. ç¼“å­˜é”®è®¾è®¡

**ç²¾ç¡®åŒ¹é…ç¼“å­˜**ï¼š
- é”®ï¼š`MD5(query)`
- å€¼ï¼š`FinalVerdict` å¯¹è±¡

**è¯­ä¹‰ç¼“å­˜**ï¼š
- é”®ï¼šæŸ¥è¯¢çš„å‘é‡è¡¨ç¤º
- ç›¸ä¼¼åº¦è®¡ç®—ï¼šä½™å¼¦ç›¸ä¼¼åº¦
- é˜ˆå€¼ï¼š0.96

### 3. ç¼“å­˜æ›´æ–°ç­–ç•¥

- **è¢«åŠ¨æ›´æ–°**: æŸ¥è¯¢æ—¶æœªå‘½ä¸­æ‰æ‰§è¡Œæµç¨‹
- **ä¸»åŠ¨æ·˜æ±°**: TTLè¿‡æœŸè‡ªåŠ¨åˆ é™¤
- **ç‰ˆæœ¬æ„ŸçŸ¥**: çŸ¥è¯†åº“æ›´æ–°æ—¶æ ‡è®°æ—§ç¼“å­˜

---

## é”™è¯¯å¤„ç†

### 1. åˆ†å±‚é”™è¯¯å¤„ç†

```
é—¨é¢å±‚
â”œâ”€â”€ æ•è·æ‰€æœ‰å¼‚å¸¸
â”œâ”€â”€ è®°å½•é”™è¯¯æ—¥å¿—
â””â”€â”€ è¿”å›å…œåº•ç»“æœ

åè°ƒå™¨å±‚
â”œâ”€â”€ æ•è·å±‚å†…å¼‚å¸¸
â”œâ”€â”€ è®°å½•è­¦å‘Šæ—¥å¿—
â””â”€â”€ è¿”å›éƒ¨åˆ†ç»“æœ

æœåŠ¡å±‚
â”œâ”€â”€ æŠ›å‡ºä¸šåŠ¡å¼‚å¸¸
â”œâ”€â”€ é‡è¯•æœºåˆ¶
â””â”€â”€ é™çº§ç­–ç•¥
```

### 2. å…œåº•æœºåˆ¶

**æŸ¥è¯¢è§£æå¤±è´¥**ï¼š
- ä½¿ç”¨å®ä½“=æŸ¥è¯¢ï¼Œä¸»å¼ =æŸ¥è¯¢

**æ£€ç´¢å¤±è´¥**ï¼š
- è¿”å›ç©ºè¯æ®åˆ—è¡¨

**åˆ†æå¤±è´¥**ï¼š
- ä½¿ç”¨é»˜è®¤è¯„ä¼°

**è£å†³ç”Ÿæˆå¤±è´¥**ï¼š
- ä½¿ç”¨å…œåº•åˆ†æï¼ˆ`summarize_with_fallback`ï¼‰
- è¿”å›"è¯æ®ä¸è¶³"

### 3. é‡è¯•ç­–ç•¥

**TruthSummarizer** é‡è¯•æœºåˆ¶ï¼š
- æœ€å¤§é‡è¯•æ¬¡æ•°ï¼š3æ¬¡
- å¤±è´¥åä½¿ç”¨å…œåº•æœºåˆ¶
- è®°å½•è¯¦ç»†é”™è¯¯æ—¥å¿—

---

## æ‰©å±•æ€§

### 1. æ·»åŠ æ–°çš„æ£€ç´¢ç­–ç•¥

```python
class RetrievalCoordinator:
    def retrieve_with_custom_strategy(self, query, strategy):
        if strategy == "aggressive":
            # æ¿€è¿›ç­–ç•¥
        elif strategy == "conservative":
            # ä¿å®ˆç­–ç•¥
```

### 2. æ·»åŠ æ–°çš„åˆ†æç»´åº¦

```python
class AnalysisCoordinator:
    def analyze_with_dimension(self, evidence_list, dimension):
        # å¤šç»´åº¦åˆ†æ
```

### 3. æ·»åŠ æ–°çš„ç›‘æ§æŒ‡æ ‡

```python
class MetricsCollector:
    def record_custom_metric(self, name, value, labels):
        # è‡ªå®šä¹‰æŒ‡æ ‡
```

---

## æ€§èƒ½æŒ‡æ ‡

### å½“å‰æ€§èƒ½ï¼ˆv0.7.0ï¼‰

| æŒ‡æ ‡ | æ•°å€¼ | è¯´æ˜ |
|------|------|------|
| ç¼“å­˜å‘½ä¸­ç‡ | ~40% | ç²¾ç¡®+è¯­ä¹‰ç¼“å­˜ |
| æœ¬åœ°æ£€ç´¢æ—¶é—´ | ~100ms | 3æ¡è¯æ® |
| å®Œæ•´æµç¨‹æ—¶é—´ | ~16s | æœ¬åœ°å‘½ä¸­åœºæ™¯ |
| å¹¶è¡Œåº¦ | 10-15 | 16æ ¸æœºå™¨ |
| APIè°ƒç”¨æ¬¡æ•° | ~15æ¬¡/æŸ¥è¯¢ | 3ä¸ªè¯æ®åˆ†æ+1æ¬¡è£å†³ |

### æ€§èƒ½ä¼˜åŒ–å†å²

- **v0.5.1**: å¹¶è¡Œè§£æå’Œæ£€ç´¢ï¼ˆ-50%æ—¶é—´ï¼‰
- **v0.6.0**: åŠ¨æ€å¹¶è¡Œåº¦ï¼ˆ+200%å¹¶è¡Œåº¦ï¼‰
- **v0.7.0**: APIç›‘æ§ï¼ˆæˆæœ¬å¯è§†åŒ–ï¼‰

---

## æœªæ¥è§„åˆ’

### çŸ­æœŸï¼ˆv0.8.0 - v0.9.0ï¼‰
- âœ… å®Œå–„æ–‡æ¡£å’Œæ³¨é‡Š
- â³ æ¶ˆé™¤ä»£ç é‡å¤

### ä¸­æœŸ
- Webä»ªè¡¨æ¿ï¼ˆå¯è§†åŒ–ï¼‰
- æ‰¹é‡æŸ¥è¯¢æ”¯æŒ
- APIé™æµå’Œç†”æ–­

### é•¿æœŸ
- åˆ†å¸ƒå¼éƒ¨ç½²
- å¤šè¯­è¨€æ”¯æŒ
- è”é‚¦å­¦ä¹ 

---

**æ–‡æ¡£ç‰ˆæœ¬**: v0.8.0
**æœ€åæ›´æ–°**: 2026-02-07
**ç»´æŠ¤è€…**: Claude (å®ˆé—¨å‘˜)
